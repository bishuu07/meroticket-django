{% extends "ticket/base_user.html" %}
{% block title %}MeroTicket{% endblock %}

{% block content %}

<!-- ========================================================= -->
<!-- ===================== HERO BANNER ========================= -->
<!-- ========================================================= -->

{% if ads and ads.count > 0 %}

<div class="hero-banner-container mb-4">
    <img id="adImageDisplay"
         class="hero-banner-media fade-ad"
         src=""
         alt="Advertisement">
</div>

<script>
    const adImages = [
        {% for ad in ads %}
            {% if ad.image %}
                "{{ ad.image.url }}",
            {% endif %}
        {% endfor %}
    ];

    let index = 0;
    const adImg = document.getElementById("adImageDisplay");

    function showAd(i) {
        adImg.classList.remove("fade-show"); // fade-out
        setTimeout(() => {
            adImg.src = adImages[i];
            adImg.classList.add("fade-show"); // fade-in
        }, 300); // matches fade-out speed
    }

    function rotateAds() {
        index = (index + 1) % adImages.length;
        showAd(index);
    }

    if (adImages.length > 0) {
        showAd(0);
        setInterval(rotateAds, 4000);
    }
</script>

{% else %}
<div class="ad-blink text-center fw-bold py-3">
    üöÄ YOU CAN ADVERTISE HERE ‚Äì CONTACT US! üöÄ
</div>
{% endif %}






<!-- ========================================================= -->
<!-- ===================== UPCOMING EVENTS ==================== -->
<!-- ========================================================= -->

<h4 class="fw-bold text-center mb-3">Upcoming Events</h4>

<div class="row justify-content-center">
    {% for event in events %}
    <div class="col-12 col-md-10 mb-4">

        <div class="card shadow-sm p-2" style="border-radius:16px;">
            <div class="row g-0">

                <!-- Event Image -->
                <div class="col-4">
                    <img src="{{ event.image.url }}"
                         class="img-fluid rounded event-img">
                </div>

                <!-- Event Info -->
                <div class="col-8 ps-3">

                    <h5 class="fw-semibold mb-1">{{ event.name }}</h5>

                    <p class="small text-muted mb-1">üìÖ {{ event.date }}</p>
                    <p class="small text-muted">üìç {{ event.location }}</p>

                    <hr class="my-2">

                    <!-- Ticket Types -->
                    {% if event.ticket_types.all %}
                        {% for t in event.ticket_types.all %}
                            <form action="{% url 'buy_ticket' t.id %}"
                                  method="get"
                                  class="d-flex justify-content-between align-items-center mt-2">

                                <div>
                                    <strong>{{ t.name }}</strong><br>
                                    Rs. {{ t.price }}
                                </div>

                                <input type="number"
                                       name="qty"
                                       value="1"
                                       min="1"
                                       max="{{ t.limit|default:10 }}"
                                       class="form-control form-control-sm"
                                       style="width: 70px;">

                                <button type="submit"
                                        class="btn btn-primary btn-sm ms-2">
                                    Buy
                                </button>
                            </form>
                        {% endfor %}
                    {% else %}
                        <p class="text-danger mt-2">No Tickets Available</p>
                    {% endif %}

                </div>

            </div>
        </div>

    </div>
    {% endfor %}
</div>

<!-- ========================================================= -->
<!-- ===================== CSS STYLES ========================= -->
<!-- ========================================================= -->

<style>
    /* Event Image */
    .event-img {
        width: 100%;
        height: 160px;
        object-fit: cover;
        border-radius: 12px;
    }

    @media (max-width: 576px) {
        .event-img {
            height: 140px;
        }
    }
    

    {% comment %} /* HERO BANNER */
    .hero-banner-container {
        width: 100%;
        height: 260px;
        border-radius: 18px;
        overflow: hidden;
        position: relative;
        background: #000;
    }

    .hero-banner-media {
        width: 100%;
        height: 100%;
        object-fit: cover;
    } {% endcomment %}

    .hero-banner-container {
        width: 100%;
        aspect-ratio: 3 / 1;  /* FIXED RATIO ‚Üí 1200x400 or 1080x360 fits perfectly */
        border-radius: 18px;
        overflow: hidden;
        position: relative;
        background: #f8f9fa;
    }

    .hero-banner-media {
        width: 100%;
        height: 100%;
        object-fit: cover;     /* Keep perfect shape */
    }


    .hero-text-banner {
        width: 100%;
        height: 260px;
        background: linear-gradient(90deg, #ff9a9e, #fad0c4);
        border-radius: 18px;
    }

    @media (max-width: 576px) {
        .hero-banner-container {
            height: 200px;
        }
        .hero-text-banner {
            height: 200px;
        }
    }

    /* Fallback AD */
    .ad-blink {
        font-size: 18px;
        padding: 10px;
        border-radius: 14px;
        background: #fff3cd;
        animation: rainbowBlink 1.2s infinite alternate;
    }

    @keyframes rainbowBlink {
        0% { color: red; }
        20% { color: orange; }
        40% { color: yellow; }
        60% { color: green; }
        80% { color: blue; }
        100% { color: purple; }
    }
    /* FADE ANIMATION */
    .fade-ad {
        opacity: 0;
        transition: opacity 0.8s ease-in-out;
    }

    .fade-show {
        opacity: 1;
    }

</style>

{% endblock %}



{% comment %} {% extends "ticket/base_user.html" %}
{% block title %}Upcoming Events{% endblock %}

{% block content %}

<!-- ===================== ADVERTISEMENT SECTION ====================== -->
<!-- ===================== ADVERTISEMENT CAROUSEL ====================== -->

<!-- ===================== ADVERTISEMENT CAROUSEL (IMAGE + VIDEO SUPPORT) ====================== -->

{% if ads and ads.count > 0 %}
<div id="adCarousel" class="carousel slide mb-4" data-bs-ride="carousel" data-bs-interval="3000">

    <div class="carousel-inner">
        
        {% for ad in ads %}
        <div class="carousel-item {% if forloop.first %}active{% endif %}">

            <div class="card shadow-sm p-3 text-center"
                 style="border-radius: 14px; background: linear-gradient(90deg, #ff9a9e, #fad0c4);">

                {% if ad.video %}
                    <!-- VIDEO AD -->
                    <video class="d-block w-100 rounded"
                           style="max-height: 260px; object-fit: cover;"
                           {% if ad.autoplay %}autoplay muted loop{% endif %}
                           controls>
                        <source src="{{ ad.video.url }}" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>

                {% elif ad.image %}
                    <!-- IMAGE AD -->
                    <img src="{{ ad.image.url }}"
                         class="d-block w-100 rounded"
                         style="max-height: 260px; object-fit: cover;">

                {% else %}
                    <!-- TEXT ONLY AD -->
                    <h4 class="fw-bold py-5">{{ ad.text }}</h4>
                {% endif %}

            </div>

        </div>
        {% endfor %}

    </div>

    <!-- Navigation Control -->
    <button class="carousel-control-prev" type="button" data-bs-target="#adCarousel" data-bs-slide="prev">
        <span class="carousel-control-prev-icon"></span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#adCarousel" data-bs-slide="next">
        <span class="carousel-control-next-icon"></span>
    </button>

</div>

{% else %}
<div class="ad-blink text-center fw-bold py-3">
    üöÄ YOU CAN ADVERTISE HERE ‚Äì CONTACT US! üöÄ
</div>
{% endif %}



<!-- ===================== EVENTS SECTION ====================== -->

<h4 class="fw-bold text-center mb-3">Upcoming Events</h4>

<div class="row justify-content-center">
    {% for event in events %}
    <div class="col-12 col-md-10 mb-4">

        <div class="card shadow-sm p-2" style="border-radius:16px;">
            <div class="row g-0">

                <!-- Event Image -->
                <div class="col-4">
                    <img src="{{ event.image.url }}"
                         class="img-fluid rounded event-img">
                </div>

                <!-- Event Info -->
                <div class="col-8 ps-3">

                    <h5 class="fw-semibold mb-1">{{ event.name }}</h5>

                    <p class="small text-muted mb-1">üìÖ {{ event.date }}</p>
                    <p class="small text-muted">üìç {{ event.location }}</p>

                    <hr class="my-2">

                    <!-- ALL TICKET TYPES -->
                    {% if event.ticket_types.all %}
                        {% for t in event.ticket_types.all %}
                            <form action="{% url 'buy_ticket' t.id %}"
                                  method="get"
                                  class="d-flex justify-content-between align-items-center mt-2">

                                <div>
                                    <strong>{{ t.name }}</strong><br>
                                    Rs. {{ t.price }}
                                </div>

                                <input type="number"
                                       name="qty"
                                       value="1"
                                       min="1"
                                       max="{{ t.limit|default:10 }}"
                                       class="form-control form-control-sm"
                                       style="width: 70px;">

                                <button type="submit"
                                        class="btn btn-primary btn-sm ms-2">
                                    Buy
                                </button>
                            </form>
                        {% endfor %}
                    {% else %}
                        <p class="text-danger mt-2">No Tickets Available</p>
                    {% endif %}

                </div>

            </div>
        </div>

    </div>
    {% endfor %}
</div>

<!-- ===================== CSS ====================== -->
<style>
    .event-img {
        width: 100%;
        height: 160px;
        object-fit: cover;
        border-radius: 12px;
    }

    @media (max-width: 576px) {
        .event-img {
            height: 140px;
        }
    }

    /* üî• Blinking rainbow advertisement placeholder */
    .ad-blink {
        font-size: 18px;
        padding: 10px;
        border-radius: 14px;
        background: #fff3cd;
        animation: rainbowBlink 1.2s infinite alternate;
    }

    @keyframes rainbowBlink {
        0% { color: red; }
        20% { color: orange; }
        40% { color: yellow; }
        60% { color: green; }
        80% { color: blue; }
        100% { color: purple; }
    }
</style>

{% endblock %} {% endcomment %}

